{% extends "base.html" %}

{% block title %}Dashboard de Reportes{% endblock %}
{% block navbar_brand_text %}Dashboard{% endblock %}

{% block main_style %}
    background-color: #f4f7f9;
    font-family: 'Poppins', sans-serif;
{% endblock %}

{% block content %}
<div class="container-xl my-4">

    <div class="mb-4">
        <h1 class="h2 page-title-text mb-0">
            <i class="bi bi-grid-1x2-fill me-2 text-primary"></i> Dashboard General de Reportes
        </h1>
        <p class="text-muted">Resumen de los últimos registros guardados en el sistema.</p>
    </div>

    <div class="row g-4">
        <!-- Tarjeta Planta -->
        <div class="col-lg-3 col-md-6">
            <div class="card dashboard-card h-100">
                <div class="card-body d-flex flex-column">
                    <div class="card-header-custom">
                        <div class="card-icon-wrapper icon-planta">
                            <i class="bi bi-buildings-fill"></i>
                        </div>
                        <h5 class="card-title">Reporte de Planta</h5>
                    </div>
                    <ul class="list-group list-group-flush flex-grow-1">
                        <li class="list-group-item">
                            <span class="item-label">Último Registro:</span>
                            <span class="item-value">
                                {% if planta_summary and planta_summary.fecha != 'N/A' %}{{ planta_summary.get('fecha', '').split('_')[0] }}{% else %}Sin Datos{% endif %}
                            </span>
                        </li>
                        <li class="list-group-item">
                            <span class="item-label">Usuario:</span>
                            <span class="item-value">{{ planta_summary.usuario if planta_summary.usuario else 'N/A' }}</span>
                        </li>
                        <li class="list-group-item">
                            <span class="item-label">Tanques Registrados:</span>
                            <span class="item-value"><strong>{{ (planta_summary.datos or [])|length }}</strong></span>
                        </li>
                    </ul>
                    <div class="card-footer-custom">
                        <a href="{{ url_for('reporte_planta') }}" class="btn btn-primary w-100"><i class="bi bi-eye-fill me-2"></i>Ver Reporte</a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tarjeta Tránsito -->
        <div class="col-lg-3 col-md-6">
            <div class="card dashboard-card h-100">
                <div class="card-body d-flex flex-column">
                    <div class="card-header-custom">
                        <div class="card-icon-wrapper icon-transito">
                            <i class="bi bi-truck"></i>
                        </div>
                        <h5 class="card-title">Reporte de Tránsito</h5>
                    </div>
                    <ul class="list-group list-group-flush flex-grow-1">
                        <li class="list-group-item">
                            <span class="item-label">Último Registro:</span>
                            <span class="item-value">
                                {% if transito_summary and transito_summary.fecha != 'N/A' %}{{ transito_summary.get('fecha', '').split('_')[0] }}{% else %}Sin Datos{% endif %}
                            </span>
                        </li>
                        <li class="list-group-item">
                            <span class="item-label">Usuario:</span>
                            <span class="item-value">{{ transito_summary.usuario if transito_summary.usuario else 'N/A' }}</span>
                        </li>
                        <li class="list-group-item">
                            <span class="item-label">NSV Consolidado:</span>
                            <span class="item-value"><strong>{{ "%.2f"|format(transito_summary.total_nsv_general|float) }}</strong></span>
                        </li>
                    </ul>
                    <div class="card-footer-custom">
                        <a href="{{ url_for('reporte_transito') }}" class="btn btn-primary w-100"><i class="bi bi-eye-fill me-2"></i>Ver Reporte</a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tarjeta Barcaza Orion -->
        <div class="col-lg-3 col-md-6">
            <div class="card dashboard-card h-100">
                <div class="card-body d-flex flex-column">
                    <div class="card-header-custom">
                        <div class="card-icon-wrapper icon-orion">
                            <i class="bi bi-water"></i>
                        </div>
                        <h5 class="card-title">Reporte Barcaza Orion</h5>
                    </div>
                    <ul class="list-group list-group-flush flex-grow-1">
                        <li class="list-group-item">
                            <span class="item-label">Último Registro:</span>
                            <span class="item-value">
                                {% if orion_summary and orion_summary.fecha != 'N/A' %}{{ orion_summary.get('fecha', '').split('_')[0] }}{% else %}Sin Datos{% endif %}
                            </span>
                        </li>
                        <li class="list-group-item">
                            <span class="item-label">Usuario:</span>
                            <span class="item-value">{{ orion_summary.usuario if orion_summary.usuario else 'N/A' }}</span>
                        </li>
                        <li class="list-group-item">
                            <span class="item-label">Total BLS:</span>
                            <span class="item-value"><strong>{{ "%.2f"|format(orion_summary.total_bls|float) }}</strong></span>
                        </li>
                    </ul>
                    <div class="card-footer-custom">
                        <a href="{{ url_for('reporte_barcaza') }}" class="btn btn-primary w-100"><i class="bi bi-eye-fill me-2"></i>Ver Reporte</a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tarjeta Barcaza BITA -->
        <div class="col-lg-3 col-md-6">
            <div class="card dashboard-card h-100">
                <div class="card-body d-flex flex-column">
                    <div class="card-header-custom">
                        <div class="card-icon-wrapper icon-bita">
                            <i class="bi bi-tsunami"></i>
                        </div>
                        <h5 class="card-title">Reporte Barcaza BITA</h5>
                    </div>
                    <ul class="list-group list-group-flush flex-grow-1">
                        <li class="list-group-item">
                            <span class="item-label">Último Registro:</span>
                            <span class="item-value">
                                {% if bita_summary and bita_summary.fecha != 'N/A' %}{{ bita_summary.get('fecha', '').split('_')[0] }}{% else %}Sin Datos{% endif %}
                            </span>
                        </li>
                        <li class="list-group-item">
                            <span class="item-label">Usuario:</span>
                            <span class="item-value">{{ bita_summary.usuario if bita_summary.usuario else 'N/A' }}</span>
                        </li>
                        <li class="list-group-item">
                            <span class="item-label">Total BLS:</span>
                            <span class="item-value"><strong>{{ "%.2f"|format(bita_summary.total_bls|float) }}</strong></span>
                        </li>
                    </ul>
                    <div class="card-footer-custom">
                        <a href="{{ url_for('reporte_barcaza_bita') }}" class="btn btn-primary w-100"><i class="bi bi-eye-fill me-2"></i>Ver Reporte</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    .page-title-text { font-weight: 600; color: #343a40; }
    .text-primary { color: #0b8552 !important; }

    .dashboard-card { border: 1px solid #e0e5ec; border-radius: 0.75rem; background-color: #ffffff; transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out; }
    .dashboard-card:hover { transform: translateY(-5px); box-shadow: 0 0.5rem 1.5rem rgba(0, 0, 0, 0.1); }
    .card-header-custom { display: flex; align-items: center; padding-bottom: 1rem; margin-bottom: 1rem; border-bottom: 1px solid #e9ecef; }
    .card-icon-wrapper { flex-shrink: 0; width: 50px; height: 50px; display: grid; place-items: center; border-radius: 50%; font-size: 1.5rem; color: #fff; margin-right: 1rem; }
    .icon-planta { background-color: #fd7e14; }
    .icon-transito { background-color: #0d6efd; }
    .icon-orion { background-color: #6f42c1; } /* Púrpura para Orion */
    .icon-bita { background-color: #198754; }  /* Verde para BITA */
    .card-title { font-size: 1.2rem; font-weight: 600; margin-bottom: 0; }
    .list-group-flush .list-group-item { display: flex; justify-content: space-between; align-items: center; padding: 0.75rem 0; border: none; }
    .item-label { color: #6c757d; font-size: 0.9rem; }
    .item-value { font-weight: 500; color: #343a40; }
    .card-footer-custom { padding-top: 1.25rem; }
</style>
{% endblock %}
